#!/bin/bash

echo "#######################################################################################################"
echo "Uninstall Trident 19.07.1"
echo "#######################################################################################################"

tridentctl -n trident uninstall

echo "#######################################################################################################"
echo "Download Trident 20.07.1"
echo "#######################################################################################################"

cd
mv trident-installer/ trident-installer_19.07
wget https://github.com/NetApp/trident/releases/download/v20.07.1/trident-installer-20.07.1.tar.gz
tar -xf trident-installer-20.07.1.tar.gz

echo "#######################################################################################################"
echo "Remove CSI Snapshots Alpha CRD"
echo "#######################################################################################################"

tridentctl -n trident obliviate alpha-snapshot-crd

echo "#######################################################################################################"
echo "Install Trident 20.07.1"
echo "#######################################################################################################"

tridentctl -n trident install

echo "#######################################################################################################"
echo "Check"
echo "#######################################################################################################"

kubectl -n trident get tridentversions